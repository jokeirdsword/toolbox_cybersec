import requests

WAF_PATTERNS = {
    "Cloudflare": "cf-ray",
    "Sucuri": "sucuri",
    "AWS WAF": "awswaf",
}

def detect_waf(target):
    try:
        response = requests.get(f"http://{target}", timeout=3)
        headers = response.headers

        detected_waf = [waf for waf, pattern in WAF_PATTERNS.items() if pattern in headers]
        return {"result": detected_waf if detected_waf else "Aucun WAF détecté"}
    except requests.RequestException:
        return {"error": "Impossible d’accéder au site"}
