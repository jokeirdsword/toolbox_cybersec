from flask import Flask, jsonify, request
import subprocess

app = Flask(__name__)

def bruteforce_login(target, service="ssh", username_file="wordlist/user-lite.txt", password_file="wordlist/password-lite.txt"):
    try:
        cmd = [
            "hydra",
            "-v",  # verbose mode
            "-L", username_file,
            "-P", password_file,
            f"{service}://{target}"
        ]
        result = subprocess.run(cmd, capture_output=True, text=True)
        output = result.stdout  # sortie brute de hydra
        return output
    except Exception as e:
        return f"Erreur : {str(e)}"

@app.route('/bruteforce', methods=['POST'])
def run_bruteforce():
    data = request.get_json()
    target = data.get("target")
    if not target:
        return jsonify({"error": "Target IP manquant"}), 400

    output = bruteforce_login(target)
    return jsonify({"result": output})

if __name__ == '__main__':
    app.run(debug=True)
